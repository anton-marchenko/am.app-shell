(self.webpackChunkam_app_shell=self.webpackChunkam_app_shell||[]).push([[943],{6449:(M,b,o)=>{o.d(b,{c:()=>h});var l=o(7970),v=o(7413),e=o(3122),g=o(3635);var C=o(3595);const f=new Map([["app1",{prod:"https://run.mocky.io/v3/9097d9ab-4b46-4516-965f-ba19d497426a",dev:"http://run.mocky.io/v3/9097d9ab-4b46-4516-965f-ba19d497426a"}],["app2",{prod:"https://run.mocky.io/v3/21c9b000-1631-4f42-8f64-8e727da6320e",dev:"http://run.mocky.io/v3/21c9b000-1631-4f42-8f64-8e727da6320e"}],["app4",{prod:"https://anton-marchenko.github.io/am.app-shell-frame-app/",dev:"http://localhost:4202/"}]]);function u(r){return f.get(r)?.prod}const p=[{alias:"home",title:"Home",description:"Simple page inside this angular app"},{alias:"about",title:"About",description:"Simple page inside this angular app"},{alias:"app1",title:"APP1",description:"Micro-front (embedded by iframe)",url:u("app1")},{alias:"app2",title:"APP2",description:"Micro-front (embedded by iframe)",url:u("app2")},{alias:"wmf",title:"APP3 (WMF)",description:"Micro-front (embedded by webpack module federation)"},{alias:"app4",title:"APP4",description:"Micro-front (embedded by iframe)",url:u("app4")}];let h=(()=>{class r{constructor(c,d){this.router=c,this.location=d,this.currApp=(0,l.computed)(()=>this.state().apps.find(s=>s.alias===this.currAppAlias())),this.iframeUrl=(0,l.computed)(()=>{const s=this.currApp()?.url,m=this.currApp()?.alias;return s+this.location.path().replace(new RegExp("^/"+m),"")}),this.navItems=(0,l.computed)(()=>{const s=this.currAppAlias();return this.state().apps.map(m=>({title:m.title,alias:m.alias,description:m.description,active:m.alias===s}))}),this.state=(0,l.signal)({loaded:!1,apps:[]}),this.navEvent=(0,e.toSignal)(this.router.events.pipe((0,g.filter)(s=>s instanceof v.NavigationEnd),(0,g.map)(s=>s.urlAfterRedirects))),this.currAppAlias=(0,l.computed)(()=>{const s=this.state();if(!s.loaded)return null;const m=this.navEvent();if(!m)return null;const x=m.match(/^\/([a-zA-Z0-9\-\_])+/)?.[0]?.replace("/","");return s.apps.find(t=>t.alias===x)?.alias??null})}init(){window.addEventListener("message",c=>{const d=c.data;if("goToApp"===d.type&&this.goToApp(d.alias),"updatePath"===d.type){const s="/"+this.currAppAlias()+d.path;this.router.navigateByUrl(s,{replaceUrl:!0})}},!1),setTimeout(()=>{this.state.mutate(c=>{c.apps=p.filter(d=>!d.disabled),c.loaded=!0})},1e3)}goToApp(c){this.router.navigate([c])}}return r.\u0275fac=function(c){return new(c||r)(l.\u0275\u0275inject(v.Router),l.\u0275\u0275inject(C.Location))},r.\u0275prov=l.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3943:(M,b,o)=>{o.r(b);var l=o(3667),v=o(7413),e=o(7970);const g=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"about",loadChildren:()=>o.e(955).then(o.bind(o,5955)).then(t=>t.ABOUT_PAGE_ROUTES)},{path:"home",loadComponent:()=>o.e(384).then(o.bind(o,3384)).then(t=>t.HomePageComponent)},{path:"wmf",loadComponent:()=>o.e(363).then(o.t.bind(o,7363,23)).then(t=>t.AppComponent)},{path:"**",loadComponent:()=>o.e(265).then(o.bind(o,5265)).then(t=>t.ContainerComponent)}];let y=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=e.\u0275\u0275defineInjector({imports:[v.RouterModule.forRoot(g),v.RouterModule]}),t})();var C=o(3122),f=o(5893),u=o(6449),p=o(3595),h=o(5861);let r=(()=>{class t{constructor(){this.version=(0,e.signal)(this.getVersion())}toggleVersion(){const a="mobile"===this.getVersion()?"desktop":"mobile";this.switchVersion(a),this.version.set(a)}getVersion(){return"mobile"===localStorage.getItem("app-version")?"mobile":"desktop"}switchVersion(n){localStorage.setItem("app-version",n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const S=["toolbarContainer"];function c(t,i){}let d=(()=>{class t{constructor(n,a){this.injector=n,this.appVersionService=a}ngAfterViewInit(){(0,e.effect)(()=>{const n=this.appVersionService.version();this.loadComponent(n).then()},{injector:this.injector})}loadComponent(n){var a=this;return(0,h.Z)(function*(){if(a.toolbarContainer.clear(),"desktop"===n){const{ToolbarDesktopComponent:T}=yield o.e(487).then(o.bind(o,1487));return void a.toolbarContainer.createComponent(T)}const{ToolbarMobileComponent:A}=yield o.e(94).then(o.bind(o,8094));a.toolbarContainer.createComponent(A)})()}}return t.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(r))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["app-toolbar"]],viewQuery:function(n,a){if(1&n&&e.\u0275\u0275viewQuery(S,5,e.ViewContainerRef),2&n){let A;e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(a.toolbarContainer=A.first)}},standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:2,vars:0,consts:[["toolbarContainer",""]],template:function(n,a){1&n&&e.\u0275\u0275template(0,c,0,0,"ng-template",null,0,e.\u0275\u0275templateRefExtractor)},dependencies:[p.CommonModule],styles:["[_nghost-%COMP%]{display:block;flex-shrink:0}"]}),t})(),s=(()=>{class t{constructor(n){this.appVersionService=n,this.currentVersion=this.appVersionService.version}toggleVersion(){this.appVersionService.toggleVersion()}}return t.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(r))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["app-footer"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:2,vars:1,consts:[[1,"reset-button",3,"click"]],template:function(n,a){1&n&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(){return a.toggleVersion()}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" switch ","mobile"===a.currentVersion()?"Desktop":"Mobile"," version\n"))},dependencies:[p.CommonModule],styles:["[_nghost-%COMP%]{display:block;text-align:center;flex-shrink:0;padding:5px;background-color:#c1bdbd72}button[_ngcontent-%COMP%]{color:#1976d2}button[_ngcontent-%COMP%]:hover{text-decoration:underline}"],changeDetection:0}),t})();function m(t,i){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"app-toolbar"),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275element(3,"router-outlet"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"app-footer"),e.\u0275\u0275elementContainerEnd())}function j(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275text(1," Loading.. "),e.\u0275\u0275elementEnd())}let x=(()=>{class t{constructor(n){this.appShellService=n,this.isAppsLoaded$=(0,C.toObservable)(this.appShellService.state).pipe((0,f.map)(a=>a.loaded))}ngOnInit(){this.appShellService.init()}}return t.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(u.c))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["app-root"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loadingTpl",""],[1,"content"],[1,"content","loading"]],template:function(n,a){if(1&n&&(e.\u0275\u0275template(0,m,5,0,"ng-container",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275template(2,j,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&n){const A=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,2,a.isAppsLoaded$))("ngIfElse",A)}},dependencies:[p.NgIf,v.RouterOutlet,d,s,p.AsyncPipe],styles:['[_nghost-%COMP%]{flex-grow:1;display:flex;flex-direction:column;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;font-size:14px;color:#333}.content[_ngcontent-%COMP%]{flex-grow:1;display:flex;width:100%;flex-direction:column;align-items:stretch;justify-content:stretch}.content.loading[_ngcontent-%COMP%]{text-align:center;margin-top:150px}']}),t})(),I=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t,bootstrap:[x]}),t.\u0275inj=e.\u0275\u0275defineInjector({imports:[l.BrowserModule,y,d,s]}),t})();l.platformBrowser().bootstrapModule(I).catch(t=>console.error(t))},5861:(M,b,o)=>{function l(e,g,y,C,f,u,p){try{var h=e[u](p),r=h.value}catch(S){return void y(S)}h.done?g(r):Promise.resolve(r).then(C,f)}function v(e){return function(){var g=this,y=arguments;return new Promise(function(C,f){var u=e.apply(g,y);function p(r){l(u,C,f,p,h,"next",r)}function h(r){l(u,C,f,p,h,"throw",r)}p(void 0)})}}o.d(b,{Z:()=>v})}}]);